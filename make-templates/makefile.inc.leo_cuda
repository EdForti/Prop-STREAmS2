#----------------------------------------------------------------------
# SUPPORTED COMPILE: nv-cuda, nv, intel, gnu, ibmxl, cray-cuda
# SUPPORTED MODES  : opt, debug [default=debug]
# SUPPORTED PRECISIONS (PREC) : single, double [default=double]
#----------------------------------------------------------------------
EQUATION = "multideal"
BACKEND  = "gpu"
COMPILE  = "nv-cuda"
MODE     = "opt"
PREC     = "double"
CUDA_VER = 11.8
MPI_CMD  = 

#-------------------------------------------------------------------------------------------------------
# IBM COMPILATION
#-------------------------------------------------------------------------------------------------------
#module load nvhpc/23.1
#module load openmpi/4.1.4--nvhpc--23.1-cuda-11.8
#-------------------------------------------------------------------------------------------------------
CGAL     = "yes"
#-------------------------------------------------------------------------------------------------------

CGAL_INCLUDE = -I/leonardo/home/userinternal/fsalvado/STREAMS/CGAL/CGAL-5.0.2/include/ -I/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include -I/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/boost-1.80.0-wykvmwvatulay54p3phkqnyl4tjxuahr/include

#-I/home/cinprod/lcalori0/02/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include -I/home/cinprod/lcalori0/02/install/0.19/linux-rhel8-icelake/gcc-11.3.0/boost-1.80.0-hpwocj4yue7oac2g3hkvxpzstdwjwssd/include

CGAL_LDFLAGS = -Wl,-rpath,/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64 /leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64/libstdc++.so.6.0.29

#-------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------
CATALYST = "v2"
#-------------------------------------------------------------------------------------------------------

ifeq (${CATALYST},"v1")
#-------------------------------------------------------------------------------------------------------
# INSITU COMPILATION - CATALYST1
#-------------------------------------------------------------------------------------------------------
#module load cmake/3.24.3
#module load gcc/11.3.0
#module load cuda/11.8
#module load python/3.10.8--gcc--11.3.0
#module load openmpi/4.1.4--gcc--11.3.0-cuda-11.8
#module load nvhpc/23.1
#module load -f openmpi/4.1.4--nvhpc--23.1-cuda-11.8
#export PARAVIEW_HOME=/leonardo_scratch/large/userinternal/fsalvado/PARAVIEW_5.8.1/Install-v5.8.1
#-------------------------------------------------------------------------------------------------------
PVDIR := ${PARAVIEW_HOME}
PARAVIEW_ROOT=${PARAVIEW_HOME}
PVINCLUDEDIR := $(PVDIR)/include/paraview-5.8
PVLIBDIR := $(PVDIR)/lib64
PVLIBS := $(shell find $(PVLIBDIR) -name '*.so')
PYLIBDIR := ${PYTHON_HOME}/lib
PYLIB := $(PYLIBDIR)/libpython3.10.so
CATALYST_INCLUDE := -I$(PVINCLUDEDIR) $(INCLUDE)
CATALYST_LDFLAGS := -Wl,-rpath,${PARAVIEW_ROOT}/lib64 ${PARAVIEW_ROOT}/lib64/libvtkParallelMPI-pv5.8.so.1 ${PARAVIEW_ROOT}/lib64/libvtkPVPythonCatalyst-pv5.8.so.5.8 ${PARAVIEW_ROOT}/lib64/libvtkPVCatalyst-pv5.8.so.5.8 ${PARAVIEW_ROOT}/lib64/libvtkPythonInterpreter-pv5.8.so.5.8 ${PYTHON_HOME}/lib/libpython3.10.so ${PARAVIEW_ROOT}/lib64/libvtkCommonDataModel-pv5.8.so.5.8 ${PARAVIEW_ROOT}/lib64/libvtkCommonTransforms-pv5.8.so.5.8 ${PARAVIEW_ROOT}/lib64/libvtkCommonMath-pv5.8.so.5.8 ${PARAVIEW_ROOT}/lib64/libvtkCommonCore-pv5.8.so.5.8 -lpthread ${PARAVIEW_ROOT}/lib64/libvtksys-pv5.8.so.5.8 -ldl -Wl,-rpath-link,${PARAVIEW_ROOT}/lib64 \
-Wl,-rpath,${GNU_HOME}/lib64 -L${GNU_HOME}/lib64 -lstdc++
#CXX := g++ -std=c++11 -O2

else ifeq (${CATALYST},"v2")
#-------------------------------------------------------------------------------------------------------
# INSITU COMPILATION - CATALYST2
#-------------------------------------------------------------------------------------------------------
#module load cmake/3.24.3
#module load gcc/11.3.0
#module load cuda/11.8
#module load python/3.10.8--gcc--11.3.0
#module load openmpi/4.1.4--gcc--11.3.0-cuda-11.8
#module load nvhpc/23.1
#module load -f openmpi/4.1.4--nvhpc--23.1-cuda-11.8
#export PARAVIEW_HOME=/leonardo_scratch/large/userinternal/fsalvado/PARAVIEW_5.11.1_OSMESA/Install-v5.11.1
#export CATALYST_IMPLEMENTATION_PATHS="/leonardo_scratch/large/userinternal/fsalvado/PARAVIEW_5.11.1_OSMESA/Install-v5.11.1/lib64/catalyst"
#export CATALYST_IMPLEMENTATION_NAME="paraview"
#export CATALYST_INSTALL_PREFIX=/leonardo_scratch/large/userinternal/fsalvado/CATALYST2_NVHPC/Install_catalyst/
#-------------------------------------------------------------------------------------------------------

CATALYST_INCLUDE := -I${CATALYST_INSTALL_PREFIX}/include/catalyst-2.0 -I${CATALYST_INSTALL_PREFIX}/include/catalyst-2.0/conduit
CATALYST_LDFLAGS := -Wl,-rpath,${CATALYST_INSTALL_PREFIX}/lib64 ${CATALYST_INSTALL_PREFIX}/lib64/libcatalyst.so.3 ${CATALYST_INSTALL_PREFIX}/lib64/libcatalyst_fortran.so -Wl,-rpath,${CATALYST_INSTALL_PREFIX}/lib64/catalyst/ 

endif
